<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="dgvncsz0f">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Install leela - leela-2.0.0-40-g7958539</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">leela-2.0.0-40-g7958539</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../user/http-interface">Http interface</a>
                            </li>
                        
                            <li >
                                <a href="../../user/leela-query-language">Leela query language</a>
                            </li>
                        
                            <li >
                                <a href="../../user/zeromq-interface">Zeromq interface</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Devel <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../devel/architecture">Architecture</a>
                            </li>
                        
                            <li >
                                <a href="../../devel/environment">Environment</a>
                            </li>
                        
                            <li >
                                <a href="../../devel">Home</a>
                            </li>
                        
                            <li >
                                <a href="../../devel/network-protocol">Network protocol</a>
                            </li>
                        
                            <li >
                                <a href="../../devel/security">Security</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Admin <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../install-cassandra">Install cassandra</a>
                            </li>
                        
                            <li >
                                <a href="../install-consul">Install consul</a>
                            </li>
                        
                            <li class="active">
                                <a href=".">Install leela</a>
                            </li>
                        
                            <li >
                                <a href="../install-redis">Install redis</a>
                            </li>
                        
                            <li >
                                <a href="../packaging-leela">Packaging leela</a>
                            </li>
                        
                            <li >
                                <a href="../tuning-leela">Tuning leela</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../install-consul">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../install-redis">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#libleela">LIBLEELA</a></li>
        
    
        <li class="main "><a href="#libleela-python">LIBLEELA-PYTHON</a></li>
        
    
        <li class="main "><a href="#warpdrive">WARPDRIVE</a></li>
        
    
        <li class="main "><a href="#collectd">COLLECTD</a></li>
        
    
        <li class="main "><a href="#blackbox">BLACKBOX</a></li>
        
    
        <li class="main "><a href="#install">INSTALL</a></li>
        
            <li><a href="#blackbox_1">BLACKBOX</a></li>
        
            <li><a href="#warpdrive_1">WARPDRIVE</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>This section contains information about how to install a Leela
cluster. Is is divided into two sections. The first covers how to
create the packages and the later how to install and configure the
packages.</p>
<p>This document will use <em>debian-wheezy</em> as the target platform and will
make use of the docker image that has been described in the
<a href="../../devel/environment">environment</a> section. If you haven't
done so refer to that document to get fetch the source code and create
the docker image.</p>
<p>Now start the container. We will use it to build every single
component:</p>
<pre><code class="bash">$ docker run \
    -v .:/leela \
    --rm -i -t \
    leela/debian7-{arch} /bin/bash
</code></pre>

<p>Also this guide will install the local packages we have just
generated. You are free to use any frontend you like but as we are
using local files we find it easier using <em>gdebi</em>.</p>
<pre><code class="bash">$ apt-get install gdebi
</code></pre>

<h2 id="libleela">LIBLEELA</h2>
<p>Libleela is the client library written in C. It is the base for the
other libraries written in other languages and also contain the
poly1305aes library. You will need it to built other leela components.</p>
<pre><code class="bash">docker $ make -C /leela/pkg libleela.debian
</code></pre>

<p>It is likely to fail since there might be a few dependencies
missing. However those can be satisfied by the package manager. So
just install those that are missing and try again.</p>
<p>On success the package will be available at:</p>
<pre><code class="bash">docker $ ls -1 /leela/pkg/dist/debian7/{arch}/libleela/
libleela-dev_{major}.{minor}.{patch}-{build}_{arch}.deb
libleela_{major}.{minor}.{patch}-{build}.dsc
libleela_{major}.{minor}.{patch}-{build}.tar.gz
libleela_{major}.{minor}.{patch}-{build}_{arch}.changes
libleela_{major}.{minor}.{patch}-{build}_{arch}.deb
</code></pre>

<h2 id="libleela-python">LIBLEELA-PYTHON</h2>
<pre><code class="bash">docker $ make -C /leela/pkg libleela-python.debian
</code></pre>

<p>Likewise, some dependencies may be missing. You must solve them and
try again. If everything went right, you should have the following
packages:</p>
<pre><code class="bash">docker $ ls -1 /leela/pkg/dist/debian7/{arch}/libleela-python
libleela-python_x.y.z-b.dsc
libleela-python_x.y.z-b.tar.gz
libleela-python_x.y.z-b_{arch}.changes
libleela-python_x.y.z-b_{arch}.deb
</code></pre>

<h2 id="warpdrive">WARPDRIVE</h2>
<p>The warpdrive is the frontend of the Leela cluster. It is the service
that allows clients to store data and retrieve
information. TODO:moreinfo.</p>
<pre><code class="bash">docker $ make -C /leela/pkg leela-warpdrive.debian
</code></pre>

<p>Which should generate the following files:</p>
<pre><code class="bash">docker $ ls -1 /leela/pkg/dist/debian7/{arch}/leela-warpdrive/
leela-warpdrive_{major}.{minor}.{patch}-{build}.dsc
leela-warpdrive_{major}.{minor}.{patch}-{build}.tar.gz
leela-warpdrive_{major}.{minor}.{patch}-{build}_{arch}.changes
leela-warpdrive_{major}.{minor}.{patch}-{build}_{arch}.deb
</code></pre>

<h2 id="collectd">COLLECTD</h2>
<p>This package provides a collectd write plugin. With this you can send
collectd metrics to Leela.</p>
<p>As usual, lets start preparing the environment. Notice that we use
collectd from source, since it is a bit unusual to compile modules.</p>
<h2 id="blackbox">BLACKBOX</h2>
<p>This is the storage backend used by the Leela cluster. It is used
internally and it the module that gives access to the cassandra
cluster. TODO:moreinfo.</p>
<p>It is written in clojure which means you will need java
[we recommend using Oracle's version, specially in production]. We
will use an Ubuntu PPA repository since debian has no java packages
but openjdk.</p>
<pre><code class="bash">docker $ /leela/automation/bootstrap/clojure-bootstrap.sh
</code></pre>

<p>After this script finishes you will have java and leiningen installed
which allows us to build the package:</p>
<pre><code class="bash">docker $ 
</code></pre>

<h1 id="install">INSTALL</h1>
<h2 id="blackbox_1">BLACKBOX</h2>
<h2 id="warpdrive_1">WARPDRIVE</h2>
<p>First install the package:</p>
<pre><code class="bash">$ gdebi install leela/pkg/leela-warpdrive_{major}.{minor}.{patch}-{build}_{arch}.deb
</code></pre>

<p>Then you must configure the daemon. The file you must change on debian
is <code>/etc/default/leela-warpdrive</code>. It is self-documented so we just
describe the most important options.</p>
<p>The following two variables defines the username and password used to
test this <code>warpdrive</code> instance. Leela uses consul for auto-discovery
and each service has a health checker associated. If the watchdog
script fails to execute the instance does not get announced.</p>
<pre><code class="bash">LEELA_WARPDRIVE_WATCHDOG_USER=
LEELA_WARPDRIVE_WATCHDOG_PASS=
</code></pre>

<p>Another very important configuration is:</p>
<pre><code class="bash">LEELA_WARPDRIVE_ENDPOINT=
</code></pre>

<p>It defines network address of this instance that will be announced in
consul. You probably will need to change it since it defaults to
local host.</p>
<p>After the <code>/etc/default/leela-warpdrive</code> properly configured, you
may start the daemon:</p>
<pre><code class="bash">$ /etc/init.d/leela-warpdrive [start|stop|restart]
</code></pre>

<p>Notice that it depends on a number of services to work correcly. Make
sure you got these dependencies satisfied before making your cluster
available:</p>
<ul>
<li>redis [<a href="../install-redis">install guide</a>]</li>
<li>consul [<a href="../install-consul">install guide</a>]</li>
<li>blackbox [<a href=".#installing-blackbox">install guide</a>]</li>
</ul>
</div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>