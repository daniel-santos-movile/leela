<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>leela chart</title>
    </head>
    <body>
    <form name="chart-it" method="get">
      <label for="endpoint">
        endpoint:
        <input id="endpoint" type="text" name="endpoint" />
      </label><br />
      <label for="hostname">
        hostname:
        <input id="hostname" type="text" name="hostname" />
      </label><br />
      <label for="service">
        service:
        <input id="service" type="text" name="service" />
      </label><br />
      <label for="fields">
        fields:
        <input id="fields" type="text" name="fields" value="_" /> *(format: field[, field, ...]; _ (underscore) is special and means all fields)
      </label><br />
      <label for="resolution">
        resolution (min):
        <input id="resolution" type="text" name="resolution" value="30" />
      </label>
      <input type="submit" />
    </form>
    <span id="uri"></span></br>
    <div id="canvas"></div>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"></script> <script type="text/javascript" src="file:///home/pothix/repos/leela-server/usr/share/leela/static/js/highcharts.js"></script>
    <script type="text/javascript" src="file:///home/pothix/repos/leela-server/usr/share/leela/static/js/functions.js"></script>
    <script type="text/javascript" src="file:///home/pothix/repos/leela-server/usr/share/leela/static/js/highcharts.js"></script>
    <script type="text/javascript" src="file:///home/pothix/repos/leela-server/usr/share/leela/static/js/widget_highcharts.js"></script>

    <script type="text/javascript">
      var qparam = function (name, defval) {
        var r = new RegExp("[\\?&]"+ name + "=([^#&]*)");
        var m = r.exec(window.location.search);
        if(m === null)
          return(defval);
        else
          return(decodeURIComponent(m[1].replace(/\+/g, " ")));
      };
      var endpoint = qparam("endpoint");
      var hostname = qparam("hostname");
      var service  = qparam("service");
      var fields   = qparam("fields");
      var res      = parseInt(qparam("resolution"));
      if (endpoint !== undefined && hostname !== undefined && service !== undefined && fields !== undefined) {
        var uri = endpoint + "/v1/"+ hostname +"/"+ service +"/"+ fields +"/past24";
        jQuery("#uri").html("<a href='" + uri + "'>data url: "+ uri +"</a>");
        jQuery("#endpoint").val(endpoint);
        jQuery("#service").val(service);
        jQuery("#hostname").val(hostname);
        jQuery("#fields").val(fields);
        jQuery("#resolution").val(res);
        jQuery.ajax(uri,
          { dataType: "jsonp",
            success: LEELA.f.dot(LEELA.widget("canvas", {resolution: res}).install, LEELA.f.average(res, 0))
          });
      }
    </script>
    </body>
</html>
